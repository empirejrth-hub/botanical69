<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏£‡∏£‡∏ì‡πÑ‡∏°‡πâ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ "‡∏™‡∏∏‡∏Ç‡∏ö‡∏ó"</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&family=Kanit:wght@500;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background: #f0fdf4; min-height: 100vh; }
        .heading-font { font-family: 'Kanit', sans-serif; }
        
        /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏∏‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ñ‡∏≠‡∏î overflow-hidden ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å glass-panel ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡∏≠‡∏ö‡∏ï‡∏±‡∏î QR Code */
        .glass-panel { 
            background: rgba(255, 255, 255, 0.9); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(16, 185, 129, 0.2); 
            position: relative; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ z-index ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ó‡∏≥‡∏á‡∏≤‡∏ô */
        }

        /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á QR Code ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏¢‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏Ç‡∏≠‡∏ö */
        .qr-container { 
            width: 85px; 
            height: 85px; 
            background: white; 
            padding: 4px; 
            border-radius: 12px; 
            border: 1px solid #e2e8f0; 
            margin: auto; 
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            z-index: 10;
        }

        /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Hover ‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏°‡∏≤‡πÑ‡∏ß‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î */
        .qr-container:hover { 
            transform: scale(3) translateY(10px); /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
            z-index: 9999 !important; /* ‡∏î‡∏∂‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border-color: #10b981;
        }

        .leaf-particle { position: fixed; pointer-events: none; z-index: 9999; animation: leafFall 2s forwards ease-out; }
        @keyframes leafFall { to { transform: translateY(100px) rotate(360deg); opacity: 0; } }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏á‡∏≠‡∏Å‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ */
        .overflow-x-auto { overflow: visible !important; }
        table { border-collapse: separate; border-spacing: 0; }

        @media print { 
            .no-print { display: none !important; } 
            .print-area { width: 100%; border: none; } 
            .qr-container:hover { transform: none; box-shadow: none; }
        }
    </style>
</head>
<body onmousemove="spawnLeaf(event)">

    <nav class="bg-emerald-900 text-white p-6 sticky top-0 z-[100] no-print shadow-xl">
        <div class="max-w-[1600px] mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <span class="text-3xl">üåø</span>
                <div>
                    <h1 class="heading-font font-bold text-xl leading-tight">‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏£‡∏£‡∏ì‡πÑ‡∏°‡πâ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• (‡∏Å.7-005)</h1>
                    <p class="text-[11px] opacity-80 uppercase tracking-widest">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ "‡∏™‡∏∏‡∏Ç‡∏ö‡∏ó"</p>
                </div>
            </div>
            <a href="index.html" class="bg-emerald-700 px-6 py-2 rounded-full text-sm font-bold hover:bg-emerald-600 transition shadow-lg">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        </div>
    </nav>

    <main class="max-w-[1600px] mx-auto px-6 py-10">
        <div class="glass-panel p-8 rounded-[2.5rem] mb-10 no-print shadow-xl">
            <div class="flex flex-col md:flex-row gap-6 items-end">
                <div class="flex-1 w-full">
                    <label class="block text-emerald-900 font-bold mb-3 ml-4 heading-font text-lg">üîç ‡∏™‡∏∑‡∏ö‡∏Ñ‡πâ‡∏ô‡∏û‡∏£‡∏£‡∏ì‡πÑ‡∏°‡πâ (‡∏ä‡∏∑‡πà‡∏≠, ‡∏£‡∏´‡∏±‡∏™, ‡∏ß‡∏á‡∏®‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏û‡∏ö)</label>
                    <input type="text" id="searchInput" onkeyup="handleSearch()" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." 
                        class="w-full px-8 py-4 rounded-2xl border-none focus:ring-4 focus:ring-emerald-500/20 bg-white shadow-inner outline-none text-lg">
                </div>
                <button onclick="window.print()" class="bg-slate-800 text-white px-10 py-4 rounded-2xl font-bold shadow-lg hover:bg-slate-700 transition flex items-center gap-3">
                    üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                </button>
            </div>
        </div>

        <div class="glass-panel rounded-[2.5rem] shadow-2xl print-area bg-white">
            <div id="loading" class="py-24 text-center">
                <p class="heading-font text-emerald-800 font-bold animate-pulse text-xl">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </div>

            <div class="overflow-x-auto p-4"> <table class="w-full text-left" id="plantTable" style="display:none;">
                    <thead>
                        <tr class="bg-emerald-800 text-white heading-font text-[12px] uppercase">
                            <th class="p-6 text-center rounded-tl-[2rem]">QR Code</th>
                            <th class="p-6">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏£‡∏£‡∏ì‡πÑ‡∏°‡πâ</th>
                            <th class="p-6">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏£‡∏£‡∏ì‡πÑ‡∏°‡πâ</th>
                            <th class="p-6">‡∏ß‡∏á‡∏®‡πå / ‡∏ß‡∏¥‡∏™‡∏±‡∏¢</th>
                            <th class="p-6 w-1/4">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏î‡πà‡∏ô</th>
                            <th class="p-6">‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏û‡∏ö</th>
                            <th class="p-6 rounded-tr-[2rem]">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="text-slate-700"></tbody>
                </table>
            </div>

            <div id="pagination" class="p-8 bg-emerald-50/50 flex justify-center items-center gap-3 no-print rounded-b-[2.5rem] border-t border-emerald-100"></div>
        </div>
    </main>

    <script>
        const scriptUrl = "https://script.google.com/macros/s/AKfycbzu-pPjwv0O4HcJDJSmxBALbdncy0pyMBqVwVTGAr3NMcCLz8gZbtkw5kLNHkO4Im3y/exec";
        let allPlants = [];
        let filteredPlants = [];
        let currentPage = 1;
        const rowsPerPage = 15;

        async function fetchPlants() {
            try {
                const response = await fetch(scriptUrl);
                const data = await response.json();
                allPlants = data.slice(1);
                filteredPlants = [...allPlants];
                renderTable();
                renderPagination();
                document.getElementById('loading').style.display = 'none';
                document.getElementById('plantTable').style.display = 'table';
            } catch (error) {
                document.getElementById('loading').innerHTML = "‚ùå ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î";
            }
        }

        function renderTable() {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const pageData = filteredPlants.slice(start, end);

            pageData.forEach(row => {
                const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(row[0])}`;

                const tr = document.createElement('tr');
                tr.className = "border-b border-emerald-50 hover:bg-emerald-50/30 transition-colors";
                tr.innerHTML = `
                    <td class="p-6 text-center">
                        <div class="qr-container">
                            <img src="${qrUrl}" alt="QR" class="w-full h-full">
                        </div>
                    </td>
                    <td class="p-6 font-bold text-emerald-900 text-[15px]">${row[0] || '-'}</td>
                    <td class="p-6">
                        <div class="font-bold text-slate-900 text-[17px]">${row[1] || '-'}</div>
                        <div class="text-[12px] italic text-emerald-600">${row[2] || '-'}</div>
                    </td>
                    <td class="p-6">
                        <div class="text-slate-500 font-medium text-[15px]">${row[3] || '-'}</div>
                        <span class="bg-emerald-100 text-emerald-800 px-3 py-1 rounded-full text-[10px] font-bold uppercase">${row[4] || '-'}</span>
                    </td>
                    <td class="p-6 text-slate-600 text-[15px]">${row[5] || '-'}</td>
                    <td class="p-6 font-bold text-emerald-700 italic text-[15px]">üìç ${row[6] || '-'}</td>
                    <td class="p-6 text-slate-400 italic text-[14px]">${row[7] || ''}</td>
                `;
                tableBody.appendChild(tr);
            });
        }

        function renderPagination() {
            const pagination = document.getElementById('pagination');
            const pageCount = Math.ceil(filteredPlants.length / rowsPerPage);
            pagination.innerHTML = '';
            for (let i = 1; i <= pageCount; i++) {
                const btn = document.createElement('button');
                btn.innerText = i;
                btn.className = `px-5 py-2.5 rounded-2xl border-2 border-emerald-100 font-bold ${currentPage === i ? 'bg-emerald-600 text-white border-emerald-600 shadow-lg' : 'bg-white text-emerald-800 hover:bg-emerald-50'}`;
                btn.onclick = () => { currentPage = i; renderTable(); renderPagination(); window.scrollTo({top: 0, behavior: 'smooth'}); };
                pagination.appendChild(btn);
            }
        }

        function handleSearch() {
            const query = document.getElementById('searchInput').value.toUpperCase();
            filteredPlants = allPlants.filter(row => row.join(' ').toUpperCase().includes(query));
            currentPage = 1;
            renderTable();
            renderPagination();
        }

        function spawnLeaf(e) {
            if (Math.random() > 0.08) return;
            const leaf = document.createElement('div');
            leaf.className = 'leaf-particle';
            leaf.style.left = e.clientX + 'px'; leaf.style.top = e.clientY + 'px';
            leaf.innerHTML = `<svg width="20" height="20" viewBox="0 0 24 24" fill="#10b981" style="opacity:0.3"><path d="M17,8C8,10 5.9,16.17 3.82,21.34L5.71,22L6.66,19.7C7.14,19.87 7.64,20 8,20C19,20 22,3 22,3C21,5 14,5.25 9,6.25C4,7.25 2,11.5 2,13.5C2,15.5 3.75,17.25 3.75,17.25C7,11 17,8 17,8Z"/></svg>`;
            document.body.appendChild(leaf);
            setTimeout(() => leaf.remove(), 2000);
        }

        window.onload = fetchPlants;
    </script>
</body>
</html>